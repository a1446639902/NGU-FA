<!DOCTYPE html>
<html lang="en">
<head>
    <!--    石良军 成交清算轧差表-->
    <title>成交清算轧差表</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link type="text/css" rel="stylesheet" href="../lib/layui/css/layui.css"/>
    <link rel="stylesheet" href="../lib/layuimini/css/public.css" media="all">
    <script type="text/javascript" src="../lib/layui/layui.js"></script>
    <script src="../lib/layuimini/js/lay-config.js?v=1.0.4" charset="utf-8"></script>

    <script type="text/html" id="tableToolBar">
        <form class="layui-form layui-col-space5">
            <div class="layui-inline">
                <input type="checkbox" lay-filter="condition" lay-skin="switch" lay-text="按日期查询|按月份查询" checked>
                <label class="layui-form-label layui-bg-green">清算日期</label>
                <div class="layui-input">
                    <input class="layui-input" onautocomplete="off" placeholder="请选择日期" name="dateTime"/>
                </div>
            </div>
            <div class="layui-inline layui-show-xs-block">
                <button class="layui-btn" lay-submit lay-event="search" lay-filter="search" id="search"><i
                        class="layui-icon">&#xe615;</i>搜索
                </button>
            </div>
        </form>
    </script>

    <script type="text/javascript">
        layui.use(['table', 'form', 'layer', 'laydate'], function () {
            var table = layui.table;
            var form = layui.form;
            var layer = layui.layer;
            var laydate = layui.laydate;
            var $ = layui.$;


            table.render({
                elem: '#myTable' //实例化表格的ID名称
                , url: '/selectTable'   //接收JSON数据的路径
                , toolbar: '#tableToolBar' //开启头部工具栏，并为其绑定左侧模板
                , title: '成交清算轧差表'//表格名称
                , cellMinWidth: 100
                , height: 'full-30'
                , cols: [
                    [
                        {field: 'name', align: 'center', title: '交易所品种'}
                        , {
                        field: 'netreceipts', align: 'center', title: '交易金额'
                        , templet: function (item) {
                            if (item.netreceipts < 0) {
                                return "<span style='color:red;'>" + item.netreceipts + "</span>";
                            } else {
                                return "<span>" + item.netreceipts + "</span>";
                            }
                        }
                    }
                        , {field: 'transfer', align: 'center', title: '过户费'}
                        , {field: 'brokerage', align: 'center', title: '经手费'}
                        , {field: 'stamp', align: 'center', title: '印花税'}
                        , {field: 'management', align: 'center', title: '征管费'}
                        , {field: 'commission', align: 'center', title: '手续费'}
                        , {
                        field: 'totalsum', align: 'center', title: '结算金额'
                        , templet: function (item) {
                            if (item.totalsum < 0) {
                                return "<span style='color:red;'>" + item.totalsum + "</span>";
                            } else {
                                return "<span>" + item.totalsum + "</span>";
                            }
                        }
                    }
                    ]
                ]
            });
            form.on('switch(condition)', function (data) {
                console.log(data.elem); //得到checkbox原始DOM对象
                console.log(); //开关是否开启，true或者false
                console.log(data.value); //开关value值，也可以通过data.elem.value得到
                alert("checkbox原始DOM对象:=" + data.elem + data.value);
                if (data.elem.checked === false) {
                    laydate.render({
                        elem: '#start'
                        , type: 'date'
                        , isInitValue: true
                        , format: 'yyyy-MM-dd'
                        , value: new Date()
                    });
                } else if (data.elem.checked === true) {
                    laydate.render({
                        elem: '#start'
                        , type: 'month'
                        , isInitValue: true
                        , format: 'yyyy-MM'
                        , value: new Date()
                    });
                }
            });
            form.on('submit(search)', function (data) {
                var dateTime = $("#start").val();

                //表格的重新加载事件
                table.reload('myTable', {
                    method: 'post'
                    , where: {
                        'dateTime': dateTime,
                    }
                    , page: {
                        curr: 1
                    }
                });
                $("#start").val(dateTime);
            });
        });
    </script>
</head>
<body>

</body>
</html>